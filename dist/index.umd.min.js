!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jspdf")):"function"==typeof define&&define.amd?define(["exports","jspdf"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["jspdf-invoice-template-nodejs"]={},e.jspdf)}(this,(function(e,t){"use strict";Object.defineProperty(e,"jsPDF",{enumerable:!0,get:function(){return t.jsPDF}}),e.OutputType={Save:"save",DataUriString:"datauristring",DataUri:"datauri",DataUrlNewWindow:"dataurlnewwindow",Blob:"blob",ArrayBuffer:"arraybuffer"},e.default=function(e){const i={outputType:e.outputType||"save",returnJsPDFDocObject:e.returnJsPDFDocObject||!1,fileName:e.fileName||"",orientationLandscape:e.orientationLandscape||!1,compress:e.compress||!1,logo:{src:e.logo?.src||"",width:e.logo?.width||"",height:e.logo?.height||"",margin:{top:e.logo?.margin?.top||0,left:e.logo?.margin?.left||0}},business:{name:e.business?.name||"",address:e.business?.address||"",phone:e.business?.phone||"",email:e.business?.email||"",email_1:e.business?.email_1||"",website:e.business?.website||""},contact:{label:e.contact?.label||"",name:e.contact?.name||"",address:e.contact?.address||"",phone:e.contact?.phone||"",email:e.contact?.email||"",otherInfo:e.contact?.otherInfo||""},invoice:{label:e.invoice?.label||"",invTotalLabel:e.invoice?.invTotalLabel||"",num:e.invoice?.num||"",invDate:e.invoice?.invDate||"",invGenDate:e.invoice?.invGenDate||"",headerBorder:e.invoice?.headerBorder||!1,tableBodyBorder:e.invoice?.tableBodyBorder||!1,header:e.invoice?.header||[],table:e.invoice?.table||[],invTotal:e.invoice?.invTotal||"",invCurrency:e.invoice?.invCurrency||"",invDescLabel:e.invoice?.invDescLabel||"",invDesc:e.invoice?.invDesc||"",row1:{col1:e.invoice?.row1?.col1||"",col2:e.invoice?.row1?.col2||"",col3:e.invoice?.row1?.col3||"",style:{fontSize:e.invoice?.row1?.style?.fontSize||12}},row2:{col1:e.invoice?.row2?.col1||"",col2:e.invoice?.row2?.col2||"",col3:e.invoice?.row2?.col3||"",style:{fontSize:e.invoice?.row2?.style?.fontSize||12}}},footer:{text:e.footer?.text||""},pageEnable:e.pageEnable||!1,pageLabel:e.pageLabel||"Page"},o=(e,t)=>{var i=a.splitTextToSize(e,t);return{text:i,height:a.getTextDimensions(i).h}};if(i.invoice.table&&i.invoice.table.length&&i.invoice.table[0].length!=i.invoice.header.length)throw Error("Length of header and table column must be equal.");const n={orientation:i.orientationLandscape?"landscape":"",compress:i.compress};var a=new t.jsPDF(n),r=a.internal.pageSize.width,c=a.internal.pageSize.height,l="#000000",s="#4d4e53",v=15,h=20,d=12,g=10,u=6,f=4;if(a.setFontSize(h),a.setTextColor(l),a.text(r-10,v,i.business.name,"right"),a.setFontSize(g),i.logo.src){var b=new Image;b.src=i.logo.src,a.addImage(b,10+i.logo.margin.left,v-5+i.logo.margin.top,i.logo.width,i.logo.height)}a.setTextColor(s),v+=f,v+=f,a.text(r-10,v,i.business.address,"right"),v+=f,a.text(r-10,v,i.business.phone,"right"),a.setFontSize(g),v+=f,a.text(r-10,v,i.business.email,"right"),v+=f,a.text(r-10,v,i.business.email_1,"right"),v+=f,a.text(r-10,v,i.business.website,"right"),i.invoice.header.length&&(v+=f,a.line(10,v,r-10,v)),a.setTextColor(s),a.setFontSize(g),v+=u,i.contact.label&&(a.text(10,v,i.contact.label),v+=u),a.setTextColor(l),a.setFontSize(h-5),i.contact.name&&a.text(10,v,i.contact.name),i.invoice.label&&i.invoice.num&&a.text(r-10,v,i.invoice.label+i.invoice.num,"right"),(i.contact.name||i.invoice.label&&i.invoice.num)&&(v+=f),a.setTextColor(s),a.setFontSize(g-2),(i.contact.address||i.invoice.invDate)&&(a.text(10,v,i.contact.address),a.text(r-10,v,i.invoice.invDate,"right"),v+=f),(i.contact.phone||i.invoice.invGenDate)&&(a.text(10,v,i.contact.phone),a.text(r-10,v,i.invoice.invGenDate,"right"),v+=f),i.contact.email&&(a.text(10,v,i.contact.email),v+=f),i.contact.otherInfo?a.text(10,v,i.contact.otherInfo):v-=f;var p=(a.getPageWidth()-20)/i.invoice.header.length;if(i.invoice.header.length>2){const e=i.invoice.header.map((e=>e?.style?.width||0)).filter((e=>e>0));let t=e.reduce(((e,t)=>e+t),0);p=(a.getPageWidth()-20-t)/(i.invoice.header.length-e.length)}var x=()=>{i.invoice.headerBorder&&(()=>{v+=2;let e=0;for(let t=0;t<i.invoice.header.length;t++){const o=i.invoice.header[t]?.style?.width||p;if(0===t)a.rect(10,v,o,7);else{const n=i.invoice.header[t-1]?.style?.width||p;e+=o==n?o:n,a.rect(e+10,v,o,7)}}v-=2})(),v+=f,a.setTextColor(l),a.setFontSize(g),a.setDrawColor(s),v+=2;let e=0;i.invoice.header.forEach((function(t,o){if(0==o)a.text(t.title,11,v);else{const n=t?.style?.width||p,r=i.invoice.header[o-1]?.style?.width||p;e+=n==r?n:r,a.text(t.title,e+11,v)}})),v+=f-1,a.setTextColor(s)};x();var m=i.invoice.table.length;i.invoice.table.forEach((function(e,t){a.line(10,v,r-10,v);var n=Math.max(...function(){let t=[];return e.forEach((function(e,n){const a=i.invoice.header[n]?.style?.width||p;let r=o(e.toString(),a-1);t.push(r.height)})),t}());i.invoice.tableBodyBorder&&(e=>{let t=0;for(let o=0;o<i.invoice.header.length;o++){const n=i.invoice.header[o]?.style?.width||p;if(0===o)a.rect(10,v,n,e);else{const r=i.invoice.header[o-1]?.style?.width||p;t+=n==r?n:r,a.rect(t+10,v,n,e)}}})(n+1);let c=0;e.forEach((function(e,t){const n=i.invoice.header[t]?.style?.width||p;let r=o(e.toString(),n-1);if(0==t)a.text(r.text,11,v+4);else{const o=e?.style?.width||p,n=i.invoice.header[t-1]?.style?.width||p;c+=o==n?o:n,a.text(r.text,11+c,v+4)}})),v+=n-4,v+=5,t+1<m&&(v+=n),i.orientationLandscape&&(v>185||v>178&&a.getNumberOfPages()>1)&&(a.addPage(),v=10,t+1<m&&x()),!i.orientationLandscape&&(v>265||v>255&&a.getNumberOfPages()>1)&&(a.addPage(),v=10,t+1<m&&x()),t+1<m&&v>30&&(v-=n)}));var w=o(i.invoice.invDesc,r/2).height,y=function(){!i.orientationLandscape&&v+w>270&&(a.addPage(),v=10)},T=function(e=173){i.orientationLandscape&&v+w>e&&(a.addPage(),v=10)};if(T(),y(),a.setTextColor(l),a.setFontSize(d),v+=u,i.invoice.header.length&&(i.invoice.invTotal||i.invoice.invTotalLabel||i.invoice.invCurrency)&&(a.line(r/2,v,r-10,v),v+=u),a.text(r/1.5,v,i.invoice.invTotalLabel,"right"),a.text(r-25,v,i.invoice.invTotal,"right"),a.text(r-10,v,i.invoice.invCurrency,"right"),i.invoice.row1&&(i.invoice.row1.col1||i.invoice.row1.col2||i.invoice.row1.col3)&&(v+=u,a.setFontSize(i.invoice.row1.style.fontSize),a.text(r/1.5,v,i.invoice.row1.col1,"right"),a.text(r-25,v,i.invoice.row1.col2,"right"),a.text(r-10,v,i.invoice.row1.col3,"right")),i.invoice.row2&&(i.invoice.row2.col1||i.invoice.row2.col2||i.invoice.row2.col3)&&(v+=u,a.setFontSize(i.invoice.row2.style.fontSize),a.text(r/1.5,v,i.invoice.row2.col1,"right"),a.text(r-25,v,i.invoice.row2.col2,"right"),a.text(r-10,v,i.invoice.row2.col3,"right")),T(),y(),a.setTextColor(l),v+=f,v+=f,a.setFontSize(d),a.getNumberOfPages()>1)for(let e=1;e<=a.getNumberOfPages();e++)a.setFontSize(g-2),a.setTextColor(s),i.pageEnable&&(a.text(r/2,c-10,i.footer.text,"center"),a.setPage(e),a.text(i.pageLabel+" "+e+" / "+a.getNumberOfPages(),r-20,a.internal.pageSize.height-6)),T(183),y();(()=>{a.setFontSize(d),a.setTextColor(l),a.text(i.invoice.invDescLabel,10,v),v+=f,a.setTextColor(s),a.setFontSize(g-1);var e=a.splitTextToSize(i.invoice.invDesc,r/2);a.text(e,10,v),v+=a.getTextDimensions(e).h>5?a.getTextDimensions(e).h+6:u})(),1===a.getNumberOfPages()&&i.pageEnable&&(a.setFontSize(g-2),a.setTextColor(s),a.text(r/2,c-10,i.footer.text,"center"),a.text(i.pageLabel+"1 / 1",r-20,a.internal.pageSize.height-6));let D={pagesNumber:a.getNumberOfPages()};if(i.returnJsPDFDocObject&&(D={...D,jsPDFDocObject:a}),"save"===i.outputType)a.save(i.fileName);else if("blob"===i.outputType){const e=a.output("blob");D={...D,blob:e}}else"datauristring"===i.outputType?D={...D,dataUriString:a.output("datauristring",{filename:i.fileName})}:"arraybuffer"===i.outputType?D={...D,arrayBuffer:a.output("arraybuffer")}:a.output(i.outputType,{filename:i.fileName});return D},Object.defineProperty(e,"__esModule",{value:!0})}));
